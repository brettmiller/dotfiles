fpath=(/usr/local/share/zsh-completions ${HOME}/.zsh.d/zsh-completions $fpath)

# completions from Homebrew installed commands
if type brew &>/dev/null; then
  FPATH=$(brew --prefix)/share/zsh/site-functions:$FPATH
fi

# don't expand aliases _before_ completion has finished
unsetopt complete_aliases

autoload -U compinit
compinit

# ignore completions for commands that don't exist
zstyle ':completion:*:functions' ignored-patterns '_*'

## Let oh-my-zsh kubectl plugin handle completions, actually no, it doesn't update completions
## completions for `kubectl`
#compdef k=kubectl
if command -v kubectl >/dev/null ; then
  source <(kubectl completion zsh)
#complete -F __start_kubectl k
fi

# completions for gh (github cli)
if command -v gh >/dev/null ; then
  #source <(gh completion -s zsh)
  gh completion -s zsh >${HOME}/.zsh.d/zsh-completions/_gh
fi

if command -v steampipe > /dev/null ; then
  steampipe completion zsh > ${HOME}/.zsh.d/zsh-completions/_steampipe
fi

# completions for `berglas`
if command -v berglas >/dev/null ; then
  source <(berglas completion zsh)
fi

# terraform
complete -o nospace -C /usr/local/bin/terraform terraform

# generated with `pip3 completion --zsh`
if command -v pip3 --version > /dev/null ; then
  source <(pip3 completion --zsh)
fi

# 1password-cli completions
if command -v op >/dev/null ; then
  source <(op completion zsh)
  compdef _op op
fi

