fpath=(/usr/local/share/zsh-completions ${HOME}/.zsh.d/zsh-completions $fpath)

# completions from Homebrew installed commands
if type brew &>/dev/null; then
  FPATH=$(brew --prefix)/share/zsh/site-functions:$FPATH
fi

# ignore completions for commands that don't exist
zstyle ':completion:*:functions' ignored-patterns '_*'

## Let oh-my-zsh kubectl plugin handle completions, actually no, it doesn't update completions
## completions for `kubectl`
#compdef k=kubectl
if command -v kubectl >/dev/null ; then
  source <(kubectl completion zsh)
#complete -F __start_kubectl k
fi


# completions for `berglas`
if command -v berglas >/dev/null ; then
  source <(berglas completion zsh)
fi

autoload -U compinit
compinit

# terraform
complete -o nospace -C /usr/local/bin/terraform terraform

# generated with `pip3 completion --zsh` 
# pip zsh completion start
function _pip_completion {
  local words cword
  read -Ac words
  read -cn cword
  reply=( $( COMP_WORDS="$words[*]" \
             COMP_CWORD=$(( cword-1 )) \
             PIP_AUTO_COMPLETE=1 $words[1] 2>/dev/null ))
}
compctl -K _pip_completion pip3
# pip zsh completion end
